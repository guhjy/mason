<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to mason • mason</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mason</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mason.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/specifics.html">Specific flows for each statistical method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lwjohnst86/mason">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to mason</h1>
                        <h4 class="author">Luke W. Johnston</h4>
            
            <h4 class="date">2017-07-28</h4>
          </div>

    
    
<div class="contents">
<blockquote>
<p><strong>Brief note</strong>: I created this package to make my analyses easier. So some statistics that have been implemented were chosen because that’s what I’ve done. If you would like a particular statistical method included, please fill out an <a href="https://github.com/lwjohnst86/mason/issues">Issue</a> and I will try to implement it!</p>
</blockquote>
<p>Most analyses follow a similar pattern to how construction/engineering projects are developed: design -&gt; add specifications -&gt; construction -&gt; (optional) add to the design and specs -&gt; cleaning, scrubbing, and polishing. The <code>mason</code> package tries to emulate this process to make it easier to do analyses in a consistent and ‘tidy’ format.</p>
<div id="basic-command-flow" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-command-flow" class="anchor"></a>Basic command flow</h2>
<p>The general command flow for using <code>mason</code> is:</p>
<ol style="list-style-type: decimal">
<li>Start the design of a blueprint for the analysis by specifying which statistical technique to use in your analysis (<code><a href="../reference/design.html">design()</a></code>).</li>
<li>Add settings/options to the blueprint for the methods of the statistics (<code><a href="../reference/add_settings.html">add_settings()</a></code>).</li>
<li>Add the variables you want to run the statistics on (<code><a href="../reference/add_variables.html">add_variables()</a></code>). These variables include the <span class="math inline">\(y\)</span> variables (outcomes), the <span class="math inline">\(x\)</span> variables (predictors), covariates, and interaction variables.</li>
<li>Using the blueprint, construct the ‘mason project’ (stats analysis) so that the results are generated (<code><a href="../reference/construct.html">construct()</a></code>).</li>
<li>Sometimes analyses are too big for one first pass, from blueprint to construction, and needs to add more to the blueprint. Use <code><a href="../reference/add_variables.html">add_variables()</a></code> or <code><a href="../reference/add_settings.html">add_settings()</a></code> after the <code><a href="../reference/construct.html">construct()</a></code> to add to the existing results.</li>
<li>When you are ready, make the ‘mason project’ cleaned up by scrubbing it down and polishing it up (<code><a href="../reference/scrub.html">scrub()</a></code> and <code>polish_*()</code> commands). The results are now ready for further presentation in a figure or table!</li>
</ol>
<div id="example-usage" class="section level3">
<h3 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example usage</h3>
<p>Let’s go over an example analysis. We’ll use <code>glm</code> for a simple linear regression. Let’s use the built-in <code>swiss</code> dataset. A quick peek at it shows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(swiss)
<span class="co">#&gt;              Fertility Agriculture Examination Education Catholic</span>
<span class="co">#&gt; Courtelary        80.2        17.0          15        12     9.96</span>
<span class="co">#&gt; Delemont          83.1        45.1           6         9    84.84</span>
<span class="co">#&gt; Franches-Mnt      92.5        39.7           5         5    93.40</span>
<span class="co">#&gt; Moutier           85.8        36.5          12         7    33.77</span>
<span class="co">#&gt; Neuveville        76.9        43.5          17        15     5.16</span>
<span class="co">#&gt; Porrentruy        76.1        35.3           9         7    90.57</span>
<span class="co">#&gt;              Infant.Mortality</span>
<span class="co">#&gt; Courtelary               22.2</span>
<span class="co">#&gt; Delemont                 22.2</span>
<span class="co">#&gt; Franches-Mnt             20.2</span>
<span class="co">#&gt; Moutier                  20.3</span>
<span class="co">#&gt; Neuveville               20.6</span>
<span class="co">#&gt; Porrentruy               26.6</span></code></pre></div>
<p>Ok, let’s say we want to several models. We are interested in <code>Fertility</code> and <code>Infant.Mortality</code> as outcomes and <code>Education</code> and <code>Agriculture</code> as potential predictors. We also want to control for <code>Catholic</code>. This setup means we have four potential models to analyze. With mason this is relatively easy. Analyses in mason are essentially separated into a blueprint phase and a construction phase. Since any structure or building always needs a blueprint, let’s get that started.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mason)
<span class="kw"><a href="../reference/design.html">design</a></span>(swiss, <span class="st">'glm'</span>)
<span class="co">#&gt; # Analysis for glm is still under construction. </span>
<span class="co">#&gt; # Showing data right now:</span>
<span class="co">#&gt; # A tibble: 47 x 6</span>
<span class="co">#&gt;   Fertility Agriculture Examination Education Catholic Infant.Mortality</span>
<span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt;    &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1      80.2        17.0          15        12     9.96             22.2</span>
<span class="co">#&gt; 2      83.1        45.1           6         9    84.84             22.2</span>
<span class="co">#&gt; 3      92.5        39.7           5         5    93.40             20.2</span>
<span class="co">#&gt; 4      85.8        36.5          12         7    33.77             20.3</span>
<span class="co">#&gt; 5      76.9        43.5          17        15     5.16             20.6</span>
<span class="co">#&gt; 6      76.1        35.3           9         7    90.57             26.6</span>
<span class="co">#&gt; # ... with 41 more rows</span></code></pre></div>
<p>So far, all we’ve done is created a blueprint of the analysis, but it doesn’t contain much. Let’s add some settings to the blueprint. mason was designed to make use of the <code>%&gt;%</code> pipes from the package <code>magrittr</code> (also found in <code>dplyr</code>), so let’s load up <code>magrittr</code>!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr)
dp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/design.html">design</a></span>(swiss, <span class="st">'glm'</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_settings.html">add_settings</a></span>(<span class="dt">family =</span> <span class="kw">gaussian</span>())</code></pre></div>
<p>You’ll notice that each time, the only thing that is printed to the console is the dataset. That’s because we haven’t constructed the analysis yet! We are still in the blueprint phase, so nothing new has been added! Since we have two outcomes and two predictors, we have a total of four models to analysis. Normally we would need to run each of the models separately. However, if simply list the outcomes and the predictors in mason, it will ‘loop’ through each combination and run all four models! Let’s add the variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dp &lt;-<span class="st"> </span>dp %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'yvars'</span>, <span class="kw">c</span>(<span class="st">'Fertility'</span>, <span class="st">'Infant.Mortality'</span>)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'xvars'</span>, <span class="kw">c</span>(<span class="st">'Education'</span>, <span class="st">'Agriculture'</span>))</code></pre></div>
<p>Alright, still nothing has happened. However, we are now at the phase that we can construct the analysis using <code><a href="../reference/construct.html">construct()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/construct.html">construct</a></span>(dp)
dp
<span class="co">#&gt; # Analysis for glm constructed but has not been scrubbed. </span>
<span class="co">#&gt; # Here is a peek at the results:</span>
<span class="co">#&gt; # A tibble: 8 x 10</span>
<span class="co">#&gt;             Yterms      Xterms        term     estimate  std.error</span>
<span class="co">#&gt;              &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1        Fertility Agriculture (Intercept) 60.304375228 4.25125562</span>
<span class="co">#&gt; 2        Fertility Agriculture XtermValues  0.194201749 0.07671176</span>
<span class="co">#&gt; 3        Fertility   Education (Intercept) 79.610058532 2.10409711</span>
<span class="co">#&gt; 4        Fertility   Education XtermValues -0.862350293 0.14484472</span>
<span class="co">#&gt; 5 Infant.Mortality Agriculture (Intercept) 20.337954766 1.05754318</span>
<span class="co">#&gt; 6 Infant.Mortality Agriculture XtermValues -0.007805071 0.01908283</span>
<span class="co">#&gt; # ... with 2 more rows, and 5 more variables: statistic &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, sample.size &lt;int&gt;</span></code></pre></div>
<p>Cool! This is the unadjusted model, without any covariates. We said we wanted to adjust for <code>Catholic</code>. But let’s say we want to keep the unadjusted analysis too. Since we have ‘finished’ the analysis by cleaning it up, we can still add to the blueprint.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dp2 &lt;-<span class="st"> </span>dp %&gt;%
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'covariates'</span>, <span class="st">'Catholic'</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/construct.html">construct</a></span>()
dp2
<span class="co">#&gt; # Analysis for glm constructed but has not been scrubbed. </span>
<span class="co">#&gt; # Here is a peek at the results:</span>
<span class="co">#&gt; # A tibble: 20 x 10</span>
<span class="co">#&gt;             Yterms      Xterms        term     estimate  std.error</span>
<span class="co">#&gt;              &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1        Fertility Agriculture (Intercept) 60.304375228 4.25125562</span>
<span class="co">#&gt; 2        Fertility Agriculture XtermValues  0.194201749 0.07671176</span>
<span class="co">#&gt; 3        Fertility   Education (Intercept) 79.610058532 2.10409711</span>
<span class="co">#&gt; 4        Fertility   Education XtermValues -0.862350293 0.14484472</span>
<span class="co">#&gt; 5 Infant.Mortality Agriculture (Intercept) 20.337954766 1.05754318</span>
<span class="co">#&gt; 6 Infant.Mortality Agriculture XtermValues -0.007805071 0.01908283</span>
<span class="co">#&gt; # ... with 14 more rows, and 5 more variables: statistic &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, sample.size &lt;int&gt;</span></code></pre></div>
<p>We now have two models in the results. We’re happy with them, so let’s clean it up using the <code><a href="../reference/scrub.html">scrub()</a></code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dp_clean &lt;-<span class="st"> </span>dp2 %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/scrub.html">scrub</a></span>()</code></pre></div>
<p>All <code><a href="../reference/scrub.html">scrub()</a></code> does is removes any extra specs in the attributes and sets the results as the main dataset. You can see this by looking at it’s details and comparing to the unscrubbed version.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(dp2)
<span class="co">#&gt; [1] "Fertility"        "Agriculture"      "Examination"     </span>
<span class="co">#&gt; [4] "Education"        "Catholic"         "Infant.Mortality"</span>
<span class="kw">colnames</span>(dp_clean)
<span class="co">#&gt;  [1] "Yterms"      "Xterms"      "term"        "estimate"    "std.error"  </span>
<span class="co">#&gt;  [6] "statistic"   "p.value"     "conf.low"    "conf.high"   "sample.size"</span>
<span class="kw">names</span>(<span class="kw">attributes</span>(dp2))
<span class="co">#&gt; [1] "names"     "class"     "row.names" "specs"</span>
<span class="kw">names</span>(<span class="kw">attributes</span>(dp_clean))
<span class="co">#&gt; [1] "names"     "class"     "row.names"</span>
<span class="kw">class</span>(dp2)
<span class="co">#&gt; [1] "bp"         "glm_bp"     "data.frame"</span>
<span class="kw">class</span>(dp_clean)
<span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></code></pre></div>
<p>And all as a single pipe chain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swiss %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/design.html">design</a></span>(<span class="st">'glm'</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_settings.html">add_settings</a></span>() %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'yvars'</span>, <span class="kw">c</span>(<span class="st">'Fertility'</span>, <span class="st">'Infant.Mortality'</span>)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'xvars'</span>, <span class="kw">c</span>(<span class="st">'Education'</span>, <span class="st">'Agriculture'</span>)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/construct.html">construct</a></span>() %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/add_variables.html">add_variables</a></span>(<span class="st">'covariates'</span>, <span class="st">'Catholic'</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/construct.html">construct</a></span>() %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/scrub.html">scrub</a></span>()
<span class="co">#&gt; # A tibble: 20 x 10</span>
<span class="co">#&gt;              Yterms      Xterms        term     estimate  std.error</span>
<span class="co">#&gt;               &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1        Fertility Agriculture (Intercept) 60.304375228 4.25125562</span>
<span class="co">#&gt;  2        Fertility Agriculture     &lt;-Xterm  0.194201749 0.07671176</span>
<span class="co">#&gt;  3        Fertility   Education (Intercept) 79.610058532 2.10409711</span>
<span class="co">#&gt;  4        Fertility   Education     &lt;-Xterm -0.862350293 0.14484472</span>
<span class="co">#&gt;  5 Infant.Mortality Agriculture (Intercept) 20.337954766 1.05754318</span>
<span class="co">#&gt;  6 Infant.Mortality Agriculture     &lt;-Xterm -0.007805071 0.01908283</span>
<span class="co">#&gt;  7 Infant.Mortality   Education (Intercept) 20.272865076 0.65272716</span>
<span class="co">#&gt;  8 Infant.Mortality   Education     &lt;-Xterm -0.030086548 0.04493333</span>
<span class="co">#&gt;  9        Fertility Agriculture (Intercept) 59.863923712 3.98753957</span>
<span class="co">#&gt; 10        Fertility Agriculture     &lt;-Xterm  0.109528109 0.07848208</span>
<span class="co">#&gt; 11        Fertility Agriculture    Catholic  0.114962125 0.04273900</span>
<span class="co">#&gt; 12        Fertility   Education (Intercept) 74.233689201 2.35197061</span>
<span class="co">#&gt; 13        Fertility   Education     &lt;-Xterm -0.788329259 0.12929324</span>
<span class="co">#&gt; 14        Fertility   Education    Catholic  0.110920955 0.02980965</span>
<span class="co">#&gt; 15 Infant.Mortality Agriculture (Intercept) 20.274208854 1.04449977</span>
<span class="co">#&gt; 16 Infant.Mortality Agriculture     &lt;-Xterm -0.020059765 0.02055767</span>
<span class="co">#&gt; 17 Infant.Mortality Agriculture    Catholic  0.016638302 0.01119509</span>
<span class="co">#&gt; 18 Infant.Mortality   Education (Intercept) 19.717357317 0.82539716</span>
<span class="co">#&gt; 19 Infant.Mortality   Education     &lt;-Xterm -0.022438401 0.04537398</span>
<span class="co">#&gt; 20 Infant.Mortality   Education    Catholic  0.011460792 0.01046136</span>
<span class="co">#&gt; # ... with 5 more variables: statistic &lt;dbl&gt;, p.value &lt;dbl&gt;,</span>
<span class="co">#&gt; #   conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, sample.size &lt;int&gt;</span></code></pre></div>
<p>There are also additional <code>polish_*</code> type commands that are more or less simply wrappers around commands that you may do on the results dataset, like filtering or renaming. The list of polish commands can be found in <code><a href="http://www.rdocumentation.org/packages/mason/topics/polish">?mason::polish</a></code>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-command-flow">Basic command flow</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Luke Johnston.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
